<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>JjChart</title>
    <base href="/" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/x-icon" href="favicon.ico" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
    <script type="text/javascript" src="./assets/html2canvas.min.js"></script>
    <script src="https://cdn.amcharts.com/lib/4/core.js"></script>
    <script src="https://cdn.amcharts.com/lib/4/charts.js"></script>
    <script src="https://cdn.amcharts.com/lib/4/themes/animated.js"></script>

    <style>
        #export {
            visibility: hidden;
            position: absolute;
            right: 160px;
            margin: 20px;
            padding: 5px;
            cursor: pointer;
            z-index: 5;
        }
    </style>
</head>

<body>
    <button id="export" onclick="screenshot();">Export</button>
    <app-root></app-root>
    <script type="text/javascript">
        function saveAs(uri, filename) {
            var link = document.createElement("a");
            if (typeof link.download === "string") {
                link.href = uri;
                link.download = filename;

                //Firefox requires the link to be in the body
                document.body.appendChild(link);

                //simulate click
                link.click();

                //remove the link when done
                document.body.removeChild(link);
            } else {
                window.open(uri);
            }
        }

        function screenshot() {
            document
                .getElementsByClassName("amcharts-Scrollbar-group")
                .forEach((element) => {
                    element.setAttribute("style", "display: none");
                });
            window
                .html2canvas(document.getElementById("container"), {
                    height: window.outerHeight + 600,
                    windowHeight: window.outerHeight + 700,
                })
                .then(function (canvas) {
                    //document.body.appendChild(canvas);
                    saveAs(canvas.toDataURL(), `jjchart${Date.now()}.png`);
                    document
                        .getElementsByClassName("amcharts-Scrollbar-group")
                        .forEach((element) => {
                            element.setAttribute("style", "display: block");
                        });
                });
        }
    </script>
</body>

</html>